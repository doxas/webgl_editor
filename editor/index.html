<!DOCTYPE html>
<html><head>
	<meta charset="UTF-8">
	<meta name="description" content="webgl editor">
	<meta name="keywords" content="webgl editor">
	<link rel="stylesheet" href="style.css" type="text/css">
	<script type="text/javascript" src="script.js"></script>
	<script src="src-noconflict/ace.js" type="text/javascript"></script>
	<script src="src-noconflict/ext-searchbox.js" type="text/javascript"></script>
	<title>webgl editor</title>
</head>
<body>
	<div id="left">
		<iframe id="frame"></iframe>
		<div id="console">
			<p>test</p>
		</div>
	</div>
	<div id="right">
		<div id="tabs">
			<div id="tabHTML" class="tab active">html</div>
			<div id="tabVertex" class="tab">vertex shader</div>
			<div id="tabFragment" class="tab">fragment shader</div>
			<div id="tabJavascript" class="tab">javascript</div>
		</div>
		<pre id="editorHTML" class="editor selected">&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;style&gt;
			* {
				margin: 0px;
				padding: 0px;
				overflow: hidden;
			}
			html, body{
				width: 100%;
				height: 100%;
			}
		&lt;/style&gt;
	&lt;/head&gt;
	&lt;body&gt;
		&lt;canvas id="c"&gt;&lt;/canvas&gt;
	&lt;/body&gt;
&lt;/html&gt;</pre>
		<pre id="editorVertex" class="editor">attribute vec3 position;
void main(void){
	gl_Position = vec4(position, 1.0);
}</pre>
		<pre id="editorFragment" class="editor">precision mediump float;
uniform float time;
uniform vec2  resolution;
vec3 hsv(float h, float s, float v){
	vec4 t = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
	vec3 p = abs(fract(vec3(h) + t.xyz) * 6.0 - vec3(t.w));
	return v * mix(vec3(t.x), clamp(p - vec3(t.x), 0.0, 1.0), s);
}
void main(void){
	vec2 p = (gl_FragCoord.xy * 2.0 - resolution) / max(resolution.x, resolution.y);
	int j = 0;
	vec2 x = vec2(-0.345, 0.654);
	vec2 y = vec2(time * 0.005, 0.0);
	vec2 z = p;
	for(int i = 0; i < 360; i++){
		j++;
		if(length(z) > 2.0){break;}
		z = vec2(z.x * z.x - z.y * z.y, 2.0 * z.x * z.y) + x + y;
	}
	float h = abs(mod(time * 15.0 - float(j), 360.0) / 360.0);
	gl_FragColor = vec4(hsv(h, 1.0, 1.0), 1.0);
}</pre>
		<pre id="editorJavascript" class="editor">var a, b, c, d, e, g, h, p, u, w, x, y, z;
b = function(s){return document.getElementById(s);};
w = window;
w.addEventListener('keydown', k, true);
c = b('c');
g = c.getContext('webgl');
p = g.createProgram();
h = function(i, j){
	k = g.createShader(g.VERTEX_SHADER - i);
	g.shaderSource(k, j);
	g.compileShader(k);
	
	// shader compile check
	if(!g.getShaderParameter(k, g.COMPILE_STATUS)){alert(g.getShaderInfoLog(k));}
	
	g.attachShader(p, k);
	return g.getShaderInfoLog(k);
};
if(!h(0, vs) && !h(1, fs)){g.linkProgram(p);}
e = g.getProgramParameter(p, g.LINK_STATUS);

// link program check
if(!e){
	alert(g.getProgramInfoLog(p));
}else{
	g.useProgram(p);
	u = {};
	u.time = g.getUniformLocation(p, 'time');
	u.resolution = g.getUniformLocation(p, 'resolution');
	g.bindBuffer(g.ARRAY_BUFFER, g.createBuffer());
	g.bufferData(g.ARRAY_BUFFER, new Float32Array([-1,1,0,-1,-1,0,1,1,0,1,-1,0]), g.STATIC_DRAW);
	a = g.getAttribLocation(p, 'position');
	g.enableVertexAttribArray(a);
	g.vertexAttribPointer(a, 3, g.FLOAT, false, 0, 0);
	g.clearColor(0, 0, 0, 1);
	z = new Date().getTime();
	(function(){
		if(!e){return;}
		c.width = x = w.innerWidth;
		c.height = y = w.innerHeight;
		g.viewport(0, 0, x, y);
		d = (new Date().getTime() - z) * 0.001;
		g.clear(g.COLOR_BUFFER_BIT);
		g.uniform1f(u.time, d);
		g.uniform2fv(u.resolution, [x, y]);
		g.drawArrays(g.TRIANGLE_STRIP, 0, 4);
		g.flush();
		requestAnimationFrame(arguments.callee);
	})();
}
function k(h){e = (h.keyCode !== 27);}</pre>
		<div id="menu">
			<div>
				<p>
					<span class="caption">append function:</span>
					<select id="appendFunction">
						<option value="">select function</option>
						<option value="all">all function</option>
						<option value="create_shader">create_shader</option>
						<option value="create_program">create_program</option>
						<option value="create_vbo">create_vbo</option>
						<option value="create_ibo">create_ibo</option>
						<option value="set_attribute">set_attribute</option>
						<option value="create_texture">create_texture</option>
						<option value="create_framebuffer">create_framebuffer</option>
						<option value="create_texture_cube">create_texture_cube</option>
						<option value="create_framebuffer_cube">create_framebuffer_cube</option>
					</select>
					<input id="appendButton" type="button" value="append">
				</p>
			</div>
			<div>
				<p>
					<input id="runButton" type="button" value="run">
					<input id="stopButton" type="button" value="stop">
				</p>
		</div>
	</div>
</body></html>


